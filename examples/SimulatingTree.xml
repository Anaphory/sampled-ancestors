<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast namespace="beast.core:beast.evolution.tree:beast.evolution.alignment:beast.core.util:beast.util:beast.evolution.operators:beast.evolution.speciation:beast.core.parameter" version="2.0">

    <taxonset spec='TaxonSet' id='taxonset'>
        <taxon spec='Taxon' id='A'/>
        <taxon spec='Taxon' id='B'/>
        <taxon spec='Taxon' id='C'/>
        <taxon spec='Taxon' id='D'/>
        <taxon spec='Taxon' id='E'/>
    </taxonset>

    <trait id="tipDates" spec='beast.evolution.tree.TraitSet' traitname='date-forward' units='year' value='
		A = 0.0,
		B = 0.0,
		C = 0.0,
		D = 0.0,
		E = 0.0'>
        <taxa idref='taxonset'/>
    </trait>

    <tree spec='TreeParser' id='tree'>
        <taxonset idref='taxonset'/>
        <input name='newick'>
            ((((A:1.0,B:1.0):1.0,C:2.0):1.0,D:3.0):1.0,E:4.0);
        </input>
        <trait idref='tipDates'/>
    </tree>


    <BDSamplingThroughTimeModel spec="SABDSamplingThroughTimeModel" id="birthDeath" tree="@tree">
        <parameter name="orig_root" id="orig_root" value ="0.5" lower="0."/>
        <!-- <parameter name="orig_root" id="orig_root" value="10." lower="0." upper="1000." dimension="1"/>   -->

        <parameter name="birthRate" id="birthRate" value="2." lower="0." upper="3." dimension="1"/>
        <parameter name="deathRate" id="deathRate" value="0.99" lower="0." upper="1." dimension="1"/>
        <parameter name="samplingRate" id="samplingRate" value="0.5" lower="0." upper="1." dimension="1"/>
        <parameter name="becomeNoninfectiousAfterSamplingProbability" id="bNASP" value="0.5" lower="0."
                   upper="1." dimension="1"/>
    </BDSamplingThroughTimeModel>

    <run chainLength="100000" id="mcmc" spec="MCMC">

        <state id="state">
            <stateNode idref='tree'/>
        </state>

        <distribution spec='CompoundDistribution' id='posterior'>
            <distribution idref='birthDeath'/>
        </distribution>

        <operator spec='ExchangeForFakeSampledAncestorTrees' isNarrow="false" weight="5" tree="@tree"/>
        <operator spec="SampledNodeDateRandomWalkerForFakeSATrees" windowSize="1" weight="5" tree="@tree" />
        <operator spec='WilsonBaldingForFakeSampledAncestorTrees' weight="10" tree="@tree"/>

        <logger logEvery="1000" fileName="SimulatingTree.$(seed).log">
            <model idref='posterior'/>
            <!-- <log idref="posterior"/> -->
            <log idref="birthDeath"/>
        </logger>
        <logger logEvery="100" fileName="SimulatingTree.$(seed).trees">
            <log idref="tree"/>
        </logger>
        <logger logEvery="1000">
            <model idref='posterior'/>
            <log idref="birthDeath"/>
        </logger>
    </run>

</beast>