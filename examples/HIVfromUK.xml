<?xml version="1.0" standalone="yes"?>
<beast version='2.0'
       namespace='beast.evolution.alignment:beast.evolution.speciation:beast.core:beast.util:beast.core.util:beast.math.distributions:beast.evolution.operators:beast.evolution.tree'>
    <taxonset spec='TaxonSet' id='taxonset'>
        <taxon spec='Taxon' id='00-101559'/>
        <taxon spec='Taxon' id='00-102536'/>
        <taxon spec='Taxon' id='00103979br'/>
        <taxon spec='Taxon' id='00-104662'/>
        <taxon spec='Taxon' id='00-106262'/>
        <taxon spec='Taxon' id='00-106349'/>
        <taxon spec='Taxon' id='00-108089'/>
        <taxon spec='Taxon' id='00-109403'/>
        <taxon spec='Taxon' id='00110107br'/>
        <taxon spec='Taxon' id='00-113442'/>
        <taxon spec='Taxon' id='00-117505'/>
        <taxon spec='Taxon' id='00-120097'/>
        <taxon spec='Taxon' id='00-121145'/>
        <taxon spec='Taxon' id='00-121644'/>
        <taxon spec='Taxon' id='00-121645'/>
        <taxon spec='Taxon' id='00-124140'/>
        <taxon spec='Taxon' id='00-124388'/>
        <taxon spec='Taxon' id='01-100990'/>
        <taxon spec='Taxon' id='01-102429'/>
        <taxon spec='Taxon' id='01-103176'/>
        <taxon spec='Taxon' id='01-106977'/>
        <taxon spec='Taxon' id='01-109401'/>
        <taxon spec='Taxon' id='01-114648'/>
        <taxon spec='Taxon' id='01-116670'/>
        <taxon spec='Taxon' id='01118281br'/>
        <taxon spec='Taxon' id='01-118495'/>
        <taxon spec='Taxon' id='01-122475'/>
        <taxon spec='Taxon' id='01-123064'/>
        <taxon spec='Taxon' id='01-123356'/>
        <taxon spec='Taxon' id='01-123913'/>
        <taxon spec='Taxon' id='01-124923'/>
        <taxon spec='Taxon' id='01-126787'/>
        <taxon spec='Taxon' id='01-127246'/>
        <taxon spec='Taxon' id='01-127879'/>
        <taxon spec='Taxon' id='01-129389'/>
        <taxon spec='Taxon' id='01-129717'/>
        <taxon spec='Taxon' id='02-101639'/>
        <taxon spec='Taxon' id='02-102688'/>
        <taxon spec='Taxon' id='02-104730'/>
        <taxon spec='Taxon' id='02-105369'/>
        <taxon spec='Taxon' id='02-105375'/>
        <taxon spec='Taxon' id='02-107361'/>
        <taxon spec='Taxon' id='02-107948'/>
        <taxon spec='Taxon' id='02-109679'/>
        <taxon spec='Taxon' id='02-112232'/>
        <taxon spec='Taxon' id='02-113391'/>
        <taxon spec='Taxon' id='02-114060'/>
        <taxon spec='Taxon' id='02-116051'/>
        <taxon spec='Taxon' id='02-117808'/>
        <taxon spec='Taxon' id='02-120328'/>
        <taxon spec='Taxon' id='02-125867'/>
        <taxon spec='Taxon' id='02-128539'/>
        <taxon spec='Taxon' id='02-129494'/>
        <taxon spec='Taxon' id='02-133011'/>
        <taxon spec='Taxon' id='02-133797'/>
        <taxon spec='Taxon' id='02-134284'/>
        <taxon spec='Taxon' id='02-134795'/>
        <taxon spec='Taxon' id='02-135749'/>
        <taxon spec='Taxon' id='03-101332'/>
        <taxon spec='Taxon' id='03-105365'/>
        <taxon spec='Taxon' id='03117546br'/>
        <taxon spec='Taxon' id='g29422869'/>
    </taxonset>

    <trait id='traitset' spec='beast.evolution.tree.TraitSet' traitname='date-forward' units='year'
           value= '00-101559 = 2000.0548,
    00-102536 = 2000.0904,
    00103979br = 2000.1425,
    00-104662 = 2000.1644,
    00-106262 = 2000.2247,
    00-106349 = 2000.2274,
    00-108089 = 2000.2959,
    00-109403 = 2000.3534,
    00110107br = 2000.3753,
    00-113442 = 2000.4959,
    00-117505 = 2000.6438,
    00-120097 = 2000.7425,
    00-121145 = 2000.7808,
    00-121644 = 2000.8,
    00-121645 = 2000.8,
    00-124140 = 2000.5,
    00-124388 = 1999.9589,
    01-100990 = 2001.0329,
    01-102429 = 2001.0795,
    01-103176 = 2001.1014,
    01-106977 = 2001.2219,
    01-109401 = 2001.2986,
    01-114648 = 2001.4658,
    01-116670 = 2001.5288,
    01118281br = 2001.5836,
    01-118495 = 2001.589,
    01-122475 = 2001.7342,
    01-123064 = 2001.7534,
    01-123356 = 2001.7616,
    01-123913 = 2001.7808,
    01-124923 = 2001.8164,
    01-126787 = 2001.8767,
    01-127246 = 2001.8959,
    01-127879 = 2001.9151,
    01-129389 = 2001.9671,
    01-129717 = 2001.9726,
    02-101639 = 2002.0247,
    02-102688 = 2002.0493,
    02-104730 = 2002.1041,
    02-105369 = 2002.1233,
    02-105375 = 2002.1233,
    02-107361 = 2002.1808,
    02-107948 = 2002.1973,
    02-109679 = 2002.2575,
    02-112232 = 2002.3315,
    02-113391 = 2002.3726,
    02-114060 = 2002.3918,
    02-116051 = 2002.4603,
    02-117808 = 2002.5096,
    02-120328 = 2002.5836,
    02-125867 = 2002.7534,
    02-128539 = 2002.8192,
    02-129494 = 2002.8466,
    02-133011 = 2002.9096,
    02-133797 = 2002.9288,
    02-134284 = 2002.9425,
    02-134795 = 2002.9507,
    02-135749 = 2002.9781,
    03-101332 = 2003.0384,
    03-105365 = 2003.1342,
    03117546br = 2003.5,
    g29422869 = 2001.5'>
        <taxa idref='taxonset'/>
    </trait>

    <tree spec='TreeParser' id='tree'>
        <taxonset idref='taxonset'/>
        <input name='newick'>
            ((((((00-101559:1.0118573414509715,(((00-106262:0.0603000000000975)00-104662:0.0731209842205196,((01-114648:0.41902445963623647,(02-116051:0.4869620968492976,03117546br:1.5266620968493365):0.9265623627869553):0.904275540363781)00103979br:0.051220984220559984):0.37937351995635193,(02-135749:0.1668183071013999,03-101332:0.22711830710127):3.099376197075625):0.6689628372741003):1.6191873241509818,((02-114060:0.21100000000001273)02-107361:1.3641634100510451,02-117808:1.6929634100510462):3.392881255551112):1.9600889232834398,((00-106349:0.5935099578110754,01-118495:1.9551099578110285):0.10213891541584852,(01-103176:1.2761725673956015,01-109401:1.4733725673956677):0.2934763058313461):4.068084715658571):1.275161889899838,((((00-120097:0.5519036547335805,(02-134795:0.5781000000001768)02-113391:2.182003654733437):1.5375330292357265,(01-102429:0.046600000000125874)01-100990:2.3798366839691703):0.17788256191990826,((01-122475:0.5533573651521642,g29422869:0.3191573651520634):2.236815750757606,((01-123913:1.1658995886444274,(02-101639:0.7573515616089548,02-112232:1.0641515616090214):0.6524480270354123):0.7645198064700183,01-129389:2.1167193951145196):0.9063537207952228):0.4688461299794824):1.6856986225758357,(01-123356:1.5827274666997941,(02-128539:2.31919999999991)00-124140:0.3211274666997501):3.389390401765237):2.6009776103203572):1.6308161541744504,(01-124923:1.1725999999998749)00-117505:8.08611163295985):3.1537083065869425,(((((00-102536:2.56715229750722,((00-109403:0.3207626474724501,01-126787:1.844062647472513):2.24579730007986,01-129717:4.185759947552402):0.2635923499548296):0.9276938948342979,((01-106977:1.3341150396780312,02-105369:2.235515039677998):1.0460568541995752,01-116670:2.687071893877648):2.2461742984638713):0.9494952496439621,(02-125867:2.794499999999971)00-124388:4.31284144198552):1.0897042492558784,(((00110107br:0.6883774575461974,(02-120328:1.7499173171839306,(02-133797:1.0136999999999716)01-127879:1.081417317183936):1.1467601403622751):2.7229667398242494,(02-102688:1.7533999999998287)00-108089:3.3319441973705963):0.15298551729146137,((00-121645:1.8401227313821389,(02-104730:0.5205000000000837)01118281br:2.6237227313821174):0.2913042781835413,(02-109679:1.4574999999999818)00-121644:2.13142700956568):1.8576027050962578):2.2546159765793297):3.3659011215235477,(((00-113442:2.0424572367505034,03-105365:4.680757236750575):0.7848770161367167,(02-107948:0.4438999999999851)01-123064:4.084834252887384):2.4117954025848034,((01-127246:2.2349111446550625,02-134284:3.2815111446551883):0.8945218878376942,((02-105375:1.2400047233951832,(02-129494:0.27690744007787327,02-133011:0.33990744007774776):1.6863972833174183):0.10249527660478952)00-121145:2.0143330324927726):3.509696622979358):4.06631715729273):1.7864731267818765):0.0;
        </input>
        <trait idref='traitset'/>
    </tree>


    <BDSamplingThroughTimeSampledAncestorModel spec="SABDSamplingThroughTimeModel" id="birthDeath" tree="@tree">
        <parameter name="orig_root" id="orig_root" value="15." lower="0." upper="100." dimension="1"/>

        <parameter name="birthRate" id="birthRate" value="0.5" lower="0." upper="3." dimension="1"/>
        <parameter name="deathRate" id="deathRate" value="0.375" lower="0." upper="1." dimension="1"/>
        <parameter name="samplingRate" id="samplingRate" value="0.125" lower="0." upper="1." dimension="1"/>
        <parameter name="becomeNoninfectiousAfterSamplingProbability" id="bNASP" value="0.5" lower="0."
                   upper="1." dimension="1"/>
    </BDSamplingThroughTimeSampledAncestorModel>

    <run spec="MCMC" id="mcmc" chainLength="10000" preBurnin="0">
        <!-- <init spec='CalibratedYuleInitialTree' id='startTree' initial='@tree'
              taxonset='@taxa' calibrations='@cal'>
        </init> -->

        <state>
            <stateNode idref='tree' />
            <stateNode idref='orig_root'/>
        </state>

        <distribution spec='CompoundDistribution' id='posterior'>
            <distribution idref='birthDeath'/>
        </distribution>

        <operator spec='WilsonBaldingForSampledAncestorTrees' weight="15" tree="@tree"/>

        <operator id='orig_scaler' spec='ScaleOperator' scaleFactor=".75" weight="1" parameter="@orig_root"/>


        <logger logEvery="1000" fileName="testSampledAncestorTreeOperator.$(seed).log">
            <model idref='posterior'/>
            <!-- <log idref="posterior"/> -->
            <log idref="birthDeath"/>
            <log idref="orig_root"/>
        </logger>
        <logger logEvery="100" fileName="testSampledAncestorTreeOperator.$(seed).trees">
            <log idref="tree"/>
        </logger>
        <logger logEvery="1000">
            <model idref='posterior'/>
            <log idref="birthDeath"/>
        </logger>
    </run>
</beast>